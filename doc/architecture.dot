    digraph G {
    
      rankdir="TD"
      
      insided -> "rule-\ntrigger-\nservice" [label="rest-api"]
      insided -> "rule-\nmanagement" [label="rest-api"]
      insided -> "user-\nmanagement" [label="rest-api"]
      insided -> "segment-\nmanagement" [label="rest-api"]
      insided -> "segment-\nquery-\nservice" [label="rest-api"]

      subgraph cluster_Web {
          label = "Web"
          "rule-\ntrigger-\nservice"
          "rule-\nmanagement"
          "user-\nmanagement"
          "segment-\nmanagement"
          "segment-\nquery-\nservice"
      }

     subgraph cluster_Core {
          label = "Core"
          "ondemand-\nactioner"
          "segment-change-\npropagation"
          "segment-change-\nactioner"
          "action-\nexecutor"
          "sms-sender"
          "email-sender"
          "group-updater"
          "crm-updater"
      }

      // subgraph cluster_External {
           //label = "External systems"
            "aws/sendgrid"
            "aws/twilio"
            "insided-system"
            "salesforce"
       // }

       "rule-\ntrigger-\nservice" -> "ondemand-\nactioner" [style=dashed, label="rule\nexec\nrequested"]
      "segment-\nmanagement" -> "segment-change-\npropagation" [style=dashed, label="segmemt\nchanged\nevent"]
      "segment-\nquery-\nservice" -> "segment-change-\npropagation" [label=query]

      "rule-\nmanagement" -> "ondemand-\nactioner" [style=dashed, label="rule\nchanged\nevent"]

      "user-\nmanagement" -> "segment-change-\npropagation" [style=dashed, label="user\nchanged\nevent"]
      "segment-change-\npropagation" -> "ondemand-\nactioner" [style=dashed, label="user-segment-event"]

      "segment-change-\npropagation" -> "segment-change-\nactioner"  [style=dashed, label="user-segment-event"]
      "rule-\nmanagement" -> "segment-change-\nactioner" [style=dashed, label="rule\nchanged\nevent"]
      "segment-change-\nactioner" -> "action-\nexecutor" [style=dashed, label="action\ntask"]

      "ondemand-\nactioner" -> "action-\nexecutor" [style=dashed, label="action\ntask"]

      "action-\nexecutor" -> "sms-sender" [label=call]
      "action-\nexecutor" -> "email-sender" [label=call]
      "action-\nexecutor" -> "group-updater" [label=call]
      "action-\nexecutor" -> "crm-updater" [label=call]

      "email-sender" -> "aws/sendgrid" [label="rest-api"]
      "sms-sender" -> "aws/twilio" [label="rest-api"]
      "group-updater" -> "insided-system" [label="rest-api"]
      "crm-updater" -> "salesforce" [label="rest-api"]

    }